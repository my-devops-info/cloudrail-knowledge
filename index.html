
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.1, mkdocs-material-7.1.8">
    
    
      
        <title>Cloudrail Knowledge</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL(".",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Cloudrail Knowledge" class="md-header__button md-logo" aria-label="Cloudrail Knowledge" data-md-component="logo">
      
  <img src="assets/cloudrail_small_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cloudrail Knowledge
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/indeni/cloudrail-knowledge/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cloudrail-knowledge
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Cloudrail Knowledge" class="md-nav__button md-logo" aria-label="Cloudrail Knowledge" data-md-component="logo">
      
  <img src="assets/cloudrail_small_logo.svg" alt="logo">

    </a>
    Cloudrail Knowledge
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/indeni/cloudrail-knowledge/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cloudrail-knowledge
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="index.html" class="md-nav__link md-nav__link--active">
        Home
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-a-context-model-with-python" class="md-nav__link">
    Why a context model with Python?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-does-cloudrails-context-model-work" class="md-nav__link">
    How does Cloudrail's context model work?
  </a>
  
    <nav class="md-nav" aria-label="How does Cloudrail's context model work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#builders" class="md-nav__link">
    Builders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mergingstitching" class="md-nav__link">
    Merging/Stitching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relationsassigner" class="md-nav__link">
    RelationsAssigner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enrichment" class="md-nav__link">
    Enrichment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-rules-work" class="md-nav__link">
    How do rules work?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-add-resource-x-or-attribute-y" class="md-nav__link">
    How do I add resource X or attribute Y?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further Reading:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-notes" class="md-nav__link">
    Some notes:
  </a>
  
    <nav class="md-nav" aria-label="Some notes:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloudrail-only-highlights-iac-backed-resources-by-default" class="md-nav__link">
    Cloudrail only highlights IaC-backed resources by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudrail-uses-checkov-for-some-static-analysis" class="md-nav__link">
    Cloudrail uses Checkov for some static analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Context
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Context" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/index.html" class="md-nav__link">
        Cloudrail's Context Model
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        AWS Context
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="AWS Context" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          AWS Context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/account/index.html" class="md-nav__link">
        account
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/apigateway/index.html" class="md-nav__link">
        apigateway
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/apigatewayv2/index.html" class="md-nav__link">
        apigatewayv2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/athena/index.html" class="md-nav__link">
        athena
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/autoscaling/index.html" class="md-nav__link">
        autoscaling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/batch/index.html" class="md-nav__link">
        batch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/cloudfront/index.html" class="md-nav__link">
        cloudfront
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/cloudhsmv2/index.html" class="md-nav__link">
        cloudhsmv2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/cloudtrail/index.html" class="md-nav__link">
        cloudtrail
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/cloudwatch/index.html" class="md-nav__link">
        cloudwatch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/codebuild/index.html" class="md-nav__link">
        codebuild
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/configservice/index.html" class="md-nav__link">
        configservice
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/dax/index.html" class="md-nav__link">
        dax
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/dms/index.html" class="md-nav__link">
        dms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/docdb/index.html" class="md-nav__link">
        docdb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/ds/index.html" class="md-nav__link">
        ds
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/dynamodb/index.html" class="md-nav__link">
        dynamodb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/ec2/index.html" class="md-nav__link">
        ec2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/ecr/index.html" class="md-nav__link">
        ecr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/ecs/index.html" class="md-nav__link">
        ecs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/efs/index.html" class="md-nav__link">
        efs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/eks/index.html" class="md-nav__link">
        eks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/elasticache/index.html" class="md-nav__link">
        elasticache
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/elb/index.html" class="md-nav__link">
        elb
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/emr/index.html" class="md-nav__link">
        emr
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/es/index.html" class="md-nav__link">
        es
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/glacier/index.html" class="md-nav__link">
        glacier
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/globalaccelerator/index.html" class="md-nav__link">
        globalaccelerator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/glue/index.html" class="md-nav__link">
        glue
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/iam/index.html" class="md-nav__link">
        iam
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/kinesis/index.html" class="md-nav__link">
        kinesis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/kms/index.html" class="md-nav__link">
        kms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/lambda_/index.html" class="md-nav__link">
        lambda_
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/mq/index.html" class="md-nav__link">
        mq
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/neptune/index.html" class="md-nav__link">
        neptune
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/networking_config/index.html" class="md-nav__link">
        networking_config
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/rds/index.html" class="md-nav__link">
        rds
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/redshift/index.html" class="md-nav__link">
        redshift
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/resourcegroupstaggingapi/index.html" class="md-nav__link">
        resourcegroupstaggingapi
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/s3/index.html" class="md-nav__link">
        s3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/s3outposts/index.html" class="md-nav__link">
        s3outposts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/sagemaker/index.html" class="md-nav__link">
        sagemaker
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/secretsmanager/index.html" class="md-nav__link">
        secretsmanager
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/sns/index.html" class="md-nav__link">
        sns
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/sqs/index.html" class="md-nav__link">
        sqs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/ssm/index.html" class="md-nav__link">
        ssm
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/worklink/index.html" class="md-nav__link">
        worklink
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/workspaces/index.html" class="md-nav__link">
        workspaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/aws/xray/index.html" class="md-nav__link">
        xray
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" >
      
      <label class="md-nav__link" for="__nav_2_3">
        Azure Context
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Azure Context" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Azure Context
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/azure/databases/index.html" class="md-nav__link">
        databases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/azure/network/index.html" class="md-nav__link">
        network
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="context/azure/webapp/index.html" class="md-nav__link">
        webapp
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Contributing Rules
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Contributing Rules" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Contributing Rules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="rules/index.html" class="md-nav__link">
        How Rules Work
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="rules/evidence.html" class="md-nav__link">
        Rules' Evidence Field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="rules/context-aware.html" class="md-nav__link">
        What is considered a "Context Aware Rule"?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="rules/tutorial/index.html" class="md-nav__link">
        Tutorial - Writing Your Own Rule
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-a-context-model-with-python" class="md-nav__link">
    Why a context model with Python?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-does-cloudrails-context-model-work" class="md-nav__link">
    How does Cloudrail's context model work?
  </a>
  
    <nav class="md-nav" aria-label="How does Cloudrail's context model work?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#builders" class="md-nav__link">
    Builders
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mergingstitching" class="md-nav__link">
    Merging/Stitching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relationsassigner" class="md-nav__link">
    RelationsAssigner
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enrichment" class="md-nav__link">
    Enrichment
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-rules-work" class="md-nav__link">
    How do rules work?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-do-i-add-resource-x-or-attribute-y" class="md-nav__link">
    How do I add resource X or attribute Y?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-reading" class="md-nav__link">
    Further Reading:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#some-notes" class="md-nav__link">
    Some notes:
  </a>
  
    <nav class="md-nav" aria-label="Some notes:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloudrail-only-highlights-iac-backed-resources-by-default" class="md-nav__link">
    Cloudrail only highlights IaC-backed resources by default
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cloudrail-uses-checkov-for-some-static-analysis" class="md-nav__link">
    Cloudrail uses Checkov for some static analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/indeni/cloudrail-knowledge/docs/README.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="overview">Overview</h1>
<p><a href="https://www.indeni.com/cloudrail">Cloudrail</a> is a tool for automating security for your Infrastructure-as-Code. For an IaC like Terraform, Cloudrail inspects your Terraform plan and validates misconfigurations using policy-as-code. Cloudrail can be integrated into your CI pipeline to automate security analysis across your organization.
Cloudrail's Policy-as-Code structure is unique as each rule will validate both your live infrastructure and IaC. Effectively, you can consolidate your cloud infrastructure analysis for live state and build state with Cloudrail's Policy-as-Code framework.</p>
<p><img alt="Cloudrail UI example" src="imgs/ui_example.png" /></p>
<p>The rules use a context model that is included in this repository. This documentation section will cover the
different aspects of the context model - how it's created, how it's used, and details of every class and attribute
in the model.</p>
<p>The code for all rules and context is located in the <a href="https://github.com/indeni/cloudrail-knowledge">cloudrail-knowledge</a>
repository.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>You are expected to be able to read and understand Python code. If you wish to submit contributions to this repository, 
you will also need to know how to write Python code. However the code used to write rules is fairly basic in structure, 
and so you don't need 10+ years of experience.</p>
<h2 id="why-a-context-model-with-python">Why a context model with Python?</h2>
<p>There are many ways to build rule engines. You could use simple query languages (like <code>jq</code>'s language), invent your own
complicated ones (like SQL), or even go and invent your own language (like HashiCorp Sentinel or OPA).  These languages can be executed on simple structured data (like JSON, YAML or XML), or more complicated data structures
(like a relational database or an object graph).</p>
<p>At the end of the day, it depends on what you're trying to achieve and what are your functional requirements.</p>
<p>For Cloudrail, this is what we wanted:
1. An imperative language, allowing for powerful logics that are easy to read (if, for, functions, etc.).
2. A language that people already knew and used and was quite common.
3. A data model that was easy to understand and reflected the terminology people were thinking in when imagining cloud 
environments.
4. An enriched model, that could carry a lot of context information and other imported data, and so powerful rules could
be written on top of it.</p>
<h2 id="how-does-cloudrails-context-model-work">How does Cloudrail's context model work?</h2>
<p>For every cloud environment supported by Cloudrail, there's an environment context. For example, there's one for 
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws">AWS</a> and one for <a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/azure">Azure</a>. In it, you'll find 
objects representing various resources supported by the specific cloud environment.</p>
<h3 id="builders">Builders</h3>
<p>Cloudrail has Builders. They're not included in this repository for simplicty, but they are simple to understand: a 
builder parses some sort of input and generate objects in the environment context as a result. For example, there's a
Terraform builder which converts an <code>aws_s3_bucket</code> into a <a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws/s3/s3_bucket.py">S3Bucket</a>.
There's also an Azure builder which takes API outputs from Azure and converts them into objects, such as the
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/azure/databases/azure_sql_server.py">AzureSqlServer</a> resource.</p>
<p>These builders allow Cloudrail to support various input sources and eventually cover all IaC languages (CloudFormation,
ARM, Bicep, Pulumi, etc.) and allows the rules to "not care" about the source of the input. The rule is the same whether
the input was from a live environment or a specific IaC language. Rules <em>can</em>, if they want, get more information about
the source of the object if it helps in their logic, but it's not a must.</p>
<h3 id="mergingstitching">Merging/Stitching</h3>
<p>For a given cloud environment, Cloudrail may receive several inputs. For examlpe, for an AWS account, Cloudrail may 
get input from both AWS API calls <em>and</em> a Terraform plan. Those are two builders, generating two separate context models.
However, as we said, one of Cloudrail's biggest advantages is in its ability to execute rules on the model wherever 
the input came from, right?</p>
<p>And so, Cloudrail runs a merging operation that allows it to take several contexts and merge them into one. To do that, 
it uses the "keys" concept. You might notice that every <a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/mergeable.py">Mergeable</a> has a 
<code>get_keys</code> function. This is used to determine if two objects, in two separate environment contexts, are actually the 
same one and should be merged.</p>
<p>The merging process also has an order of precedence. If the same object is seen twice from two sources, it knows how to 
decide which source is more recent or up to date, and use that one as the primary source of content.</p>
<p>Once merging is done, there's one, unified context model, representing the entire environment.</p>
<h3 id="relationsassigner">RelationsAssigner</h3>
<p>After the context is merged, Cloudrail begins "connecting the dots". At this phase, the model becomes a "graph model" 
and so objects can begin pointing to one another. For example, an 
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws/iam/iam_identity.py">IAMIdentiy</a> will point to its policies, or a 
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws/ec2/subnet.py">Subnet</a> will point to its VPC.</p>
<p>This makes it a lot easier to write rule code, as you don't need to do any lookups. Finding a subnet's VPC, is just a 
matter of using its <code>vpc</code> attribute.</p>
<h3 id="enrichment">Enrichment</h3>
<p>This is one of the coolest parts of Cloudrail and follows the relation assignment. This is where the object model becomes more valuable than just
representing the input in a graph model. Cloudrail now uses various algorithms to import valuable information into the 
context model and make it accessible to the rule writer.</p>
<p>For example, want to know if a resource is publicly accessible, and how? Look at the attribute exposed by
those classes that inherit from <a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws/aws_connection.py">ConnectionInstance</a>.</p>
<p>Want to know if a policy violates AWS's best practices? Look at
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/context/aws/iam/policy.py">Policy</a>'s <code>access_analyzer_findings</code> attribute.</p>
<h2 id="how-do-rules-work">How do rules work?</h2>
<p>A rule is a Python class inheriting from <a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/rules/base_rule.py">BaseRule</a>. It has a simple
<code>run</code> function where all the logic is executed. A rule returns a response which includes a list of issues that it found.
Every issue, has a few attributes:</p>
<ul>
<li>Exposed resource - this is the resource who is exposed (from a security perspective) by the violation found.
Note that often times the exposed resource is <em>different</em> from the violating resource.</li>
<li>Violating resource - this is the resource which violated the rule's logic. Usually, this resource is the one
that needs to be fixed.</li>
<li>Evidence - this is a human-readable string that is used to help the user understand what the issue is and where to
look when fixing it.</li>
</ul>
<p>Rules are registered for execution via the metadata files (such as 
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/rules/aws/aws_rules_metadata.yaml">aws_rules_metadata.yaml</a> and 
<a href="https://github.com/indeni/cloudrail-knowledge/tree/main/cloudrail/knowledge/rules/azure/azure_rules_metadata.yaml">azure_rules_metadata.yaml</a>). Cloudrail loads the
metadata information and uses it to build a list of rules to run. It also uses this metadata to show
the user information about each rule.</p>
<p>A rule only decides if a configuration is violating its logic or not. A rule does <em>not</em> decide what to do with that
violation. It is up to a separate mechanism to decide if the violation is an error or a warning, or whether or not 
to return exit code 1 or 0 in the Cloudrail CLI.</p>
<p>If you're interested in seeing how to write your own custom rule, <a href="https://youtu.be/MQfpKDQAW8o">check out this video</a>.</p>
<h2 id="how-do-i-add-resource-x-or-attribute-y">How do I add resource X or attribute Y?</h2>
<p>If you're missing a specific object you care about, or you found the object but it's missing an attribute, you'll need 
our help in adding it. Since builders, relations assignment, enrichment, etc, are required for every object and many 
attributes, this work needs to be done by the Indeni team in the core engine. To request a specific object or attribute, 
simply open an issue in this repository and we'll get right to it.</p>
<h2 id="further-reading">Further Reading:</h2>
<ul>
<li><a href="context/index.html">Details of the context model</a></li>
<li><a href="rules/index.html">How rules work and writing your own</a></li>
</ul>
<h2 id="some-notes">Some notes:</h2>
<h4 id="cloudrail-only-highlights-iac-backed-resources-by-default">Cloudrail only highlights IaC-backed resources by default</h4>
<p>Let's say a rule found a violation in a specific object in the context model and created an issue with an exposed
resource and violating resource. The issue will only be presented to the user within the CI/CD process if
either one of the resources (or both) comes from the Terraform plan (or IaC code) submitted for review by the user.</p>
<p>In other words, if both exposed and violating resources are not in the IaC code at all, they will be removed from the
rule output by default. A rule can override this behavior by returning <code>True</code> for <code>filter_non_iac_managed_issues</code>.</p>
<h4 id="cloudrail-uses-checkov-for-some-static-analysis">Cloudrail uses Checkov for some static analysis</h4>
<p>In some cases, Cloudrail will leverage <a href="https://github.com/bridgecrewio/checkov">Checkov</a> to do static analysis. This is
mainly in cases where the context hasn't yet been fully built out. We generally strive to cover all the commonly used
cloud resources quickly, but allow the use of Checkov rules where the context model doesn't exist yet.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
      
        
        <a href="context/index.html" class="md-footer__link md-footer__link--next" aria-label="Next: Cloudrail&#39;s Context Model" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cloudrail's Context Model
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            indeni
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.b0710199.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.76f349be.min.js"></script>
      
    
  </body>
</html>